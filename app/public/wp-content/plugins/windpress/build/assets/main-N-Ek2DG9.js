import{T as We,b as Ve,d as De}from"./runtime-dom.esm-bundler-CZCO9KQc.min.js";import{l as q}from"./logger-BTW-zIW3.js";import{L as ze,_ as Me,a as Oe,G as je,R as Fe}from"./chevron-right-BERryxJP.min.js";import{brx as Z,brxGlobalProp as U,brxIframe as Re}from"./constant-ClLhar2j.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.min.js";import{a5 as _,r as J,ar as Ue,aE as B,_ as b,a1 as m,Z as w,am as T,j as E,u as x,a2 as Be,V as $,w as W,an as Q,as as V,ak as He,Y as I,$ as D,F as z,a0 as M,a3 as H,X as Ne,aD as Xe,n as Ye}from"./runtime-core.esm-bundler-HqF9pg4M.min.js";import{d as Ge}from"./vfs-D2UpcTQ4.js";import"./index-Cpd--BI3.min.js";import{__tla as Ke}from"./cssesc-oI9k1TGw.js";import"./index-C5HG4pYD.min.js";import{__tla as Ze}from"./index-B1TOZHNa.min.js";import{g as Je}from"./intellisense-C4SCibOB.js";import"./redaxios.module-D8m3meIN.min.js";import{l as Qe}from"./design-system-BcwYkYVv.js";import{u as et}from"./index-l5GBeiGs.min.js";import{s as tt}from"./set-Dt5k9sTt.min.js";import"./floating-ui.core-0WkvgGWJ.min.js";import"./virtualRef-CgRKHaPH.js";import"./get-DBhW7rda.min.js";import"./_toKey-BxB36GnB.min.js";import"./isObject-K1YoVIH1.min.js";import"./chunk-HTB5LLOP-Cay67bh1.min.js";import"./preload-helper-CsYsLKPR.min.js";import"./source-map-generator-DjbDy59a.min.js";import"./index-CgqXENQe.min.js";import"./index-BAMY2Nnw.min.js";import"./index-BkiRcEwW.min.js";import"./pre-process-BSusP0Xd.js";Promise.all([(()=>{try{return Ke}catch{}})(),(()=>{try{return Ze}catch{}})()]).then(async()=>{const ee={id:"windpressbricks-variable-app-header",class:"header-container"},te={class:"header-content"},oe={class:"header-logo"},ae={class:"header-title"},re={__name:"PanelHeader",setup(r){const t=_("variableApp"),o=_("isOpen");function g(){const c=t.querySelector("#windpressbricks-variable-app-header");let p=$(!1),k=0,v=0;W(p,l=>{l?(document.body.style.userSelect="none",Z.style.pointerEvents="none",c.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),Z.style.removeProperty("pointer-events"),c.style.cursor="grab")});const s=l=>{p.value=!0;const a=c.getBoundingClientRect();k=l.clientX-a.left,v=l.clientY-a.top};c.removeEventListener("mousedown",s),c.addEventListener("mousedown",s);const d=l=>{if(!p.value)return;const a=c.getBoundingClientRect(),u=l.clientX,e=l.clientY,n=u-k,i=e-v,f=n<0?0:n>window.innerWidth-a.width?window.innerWidth-a.width:n,h=i<0?0:i>window.innerHeight-a.height?window.innerHeight-a.height:i;t.style.left=`${f}px`,t.style.top=`${h}px`};document.removeEventListener("mousemove",d),document.addEventListener("mousemove",d);const y=l=>{p.value=!1};document.removeEventListener("mouseup",y),document.addEventListener("mouseup",y)}return J(()=>{g()}),(c,p)=>{const k=Ue("inline-svg"),v=Me,s=B("tooltip");return m(),b("div",ee,[w("div",te,[w("div",oe,[E(k,{src:x(ze),class:"inline-svg"},null,8,["src"])]),T((m(),b("div",ae,p[1]||(p[1]=[Be(" WindPress ")]))),[[s,{placement:"top",content:`v${c.windpressbricks._version}`}]]),T((m(),b("button",{class:"header-exit",onClick:p[0]||(p[0]=d=>o.value=!x(o))},[E(v,{class:"iconify"})])),[[s,{placement:"top",content:"Close"}]])])])}}},ne=P(re,[["__scopeId","data-v-97f7f622"]]),le={class:"header-slot"},se={key:0,class:"expansion-panel__body"},ie={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(r,{expose:t}){const o=r,g=$(null),c=et(`windpressbricks-variable-app.ui.expansion-panels.${o.namespace}`,{[`${o.name}`]:!1},void 0,{mergeDefaults:!0});function p(v){c.value[o.name]=v===null?!c.value[o.name]:v}function k(){g.value.scrollIntoView()}return t({togglePanel:p,scrollIntoView:k}),(v,s)=>{const d=Oe;return m(),b("div",{ref_key:"sectionRef",ref:g,class:"expansion-panel"},[w("div",{class:He([{},"expansion-panel__header"]),onClick:s[0]||(s[0]=y=>x(c)[r.name]=!x(c)[r.name])},[w("div",le,[Q(v.$slots,"header",{},void 0,!0)]),w("div",null,[E(d,{style:V({transform:x(c)[r.name]?"rotate(-90deg)":"rotate(0deg)"}),class:"iconify"},null,8,["style"])])]),E(We,null,{default:I(()=>[x(c)[r.name]?(m(),b("div",se,[Q(v.$slots,"default",{},void 0,!0)])):D("",!0)]),_:3})],512)}}},O=P(ie,[["__scopeId","data-v-48d9357f"]]),ce={class:"{m:10;pb:15}>div"},ue={class:"variable-section-title font:14 my:10"},pe={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},de=["onClick","onMouseenter"],ve={class:"font:14"},me=1e3,be={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(r){const t=_("focusedInput"),o=_("recentVariableSelectionTimestamp"),g=_("tempInputValue");function c(v,s){performance.now()-o.value<me||t.value&&(t.value.value=`var(${s})`,t.value.dispatchEvent(new Event("input")),t.value.focus())}function p(v){!t.value||g.value===null||(t.value.value=g.value,t.value.dispatchEvent(new Event("input")),t.value.focus())}function k(v,s){t.value&&(t.value.value=`var(${s})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),g.value=`var(${s})`,o.value=performance.now())}return(v,s)=>{const d=B("tooltip");return m(),b("div",ce,[(m(!0),b(z,null,M(r.variableItems,(y,l)=>(m(),b("div",{key:l,class:"var-item"},[w("div",ue,H(l.replace("_","-")),1),w("div",pe,[y.length>0?(m(!0),b(z,{key:0},M(y,(a,u)=>T((m(),b("button",{key:u,class:"px:12 py:8 r:$(builder-border-radius) fg:$(builder-color) bg:$(builder-bg-2) bg:$(builder-bg-3):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% text:center {opacity:.5;font:semibold}>span opacity:100:hover>span",onClick:e=>k(e,a.key),onMouseenter:e=>c(e,a.key),onMouseleave:p},[w("span",ve,H(a.label),1)],40,de)),[[d,{placement:"top",content:`var(${a.key}, ${a.value})`}]])),128)):D("",!0)])]))),128))])}}},N=P(be,[["__scopeId","data-v-ecbe9380"]]);function j(){var t,o;if(U.$_state.activePanel!=="element")return null;const r=(t=U.$_state)==null?void 0:t.activeElement.id;return(o=U.$_getIframeDoc())==null?void 0:o.getElementById(`brxe-${r}`)}function ye({selector:r,callback:t,options:o}){const g=new MutationObserver(t),c=document.querySelector(r);if(!c){q(`Target not found for selector: ${r}`,{module:"variable-picker",type:"error"});return}const p={childList:!0,subtree:!0};g.observe(c,Object.assign(Object.assign({},p),o))}const fe={class:"{m:10;pb:15}>div"},ge={class:"variable-section-title"},ke={key:0,class:"variable-section-items default-color"},he=["onClick","onMouseenter"],we=["onClick","onMouseenter"],_e=1e3,Ee={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(r){const t=_("focusedInput"),o=_("recentColorPickerTarget"),g=_("recentVariableSelectionTimestamp"),c=_("tempInputValue");function p(l,a){var u;if(!(performance.now()-g.value<_e)){if(!t.value){const e=j();if(!e)return;const n=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:i,control:f}of n)(u=o.value)!=null&&u.closest(`[data-control="${f}"]`)&&(e.style[i]=`var(${a})`);return}t.value.value=`var(${a})`,t.value.dispatchEvent(new Event("input")),t.value.focus()}}function k(l){var a;if(!t.value||c.value===null){const u=j();if(!u)return;const e=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:n,control:i}of e)(a=o.value)!=null&&a.closest(`[data-control="${i}"]`)&&(u.style[n]="");return}t.value.value=c.value,t.value.dispatchEvent(new Event("input")),t.value.focus()}function v(l,a){if(l.stopPropagation(),l.preventDefault(),!t.value){const u=o.value;y(a),g.value=performance.now(),setTimeout(()=>{const e=j();if(!e)return;const n=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:i,control:f}of n)u!=null&&u.closest(`[data-control="${f}"]`)&&(e.style[i]="")},5);return}t.value.value=`var(${a})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),c.value=`var(${a})`,g.value=performance.now()}function s(){document.querySelectorAll(".windpressbricks-variable-app-colorpopup").forEach(l=>{l.remove()})}function d(){if(document.querySelector(".windpressbricks-variable-app-colorpopup"))return;const l=".bricks-control-popup { display: none !important; }",a=document.createElement("style");a.id="windpressbricks-variable-app-bricks-popup",a.appendChild(document.createTextNode(l)),a.classList.add("windpressbricks-variable-app-colorpopup"),document.head.appendChild(a)}async function y(l){var u,e,n,i,f;d(),document.querySelector(".bricks-control-popup .color-palette.grid")||((e=(u=o.value)==null?void 0:u.closest(".bricks-control-preview"))==null||e.click(),await new Promise(h=>setTimeout(h,25)));const a=document.querySelector(".bricks-control-popup .color-palette.grid");a?(i=(n=a.querySelector(`[data-balloon="var(${l})"]`))==null?void 0:n.parentElement)==null||i.click():q("Failed to select color. Color grid not found.",{module:"variable-picker",type:"error"}),(f=document.querySelector("body"))==null||f.click(),await new Promise(h=>setTimeout(h,2)),document.querySelector(".bricks-control-popup")?(setTimeout(()=>{var h;(h=document.querySelector("body"))==null||h.click(),setTimeout(()=>{s()},5)},5),q("Failed to close color picker. Delaying close.",{module:"variable-picker",type:"error"})):s()}return(l,a)=>{const u=B("tooltip");return m(),b("div",fe,[(m(!0),b(z,null,M(r.variableItems,(e,n)=>(m(),b("div",{key:n,class:""},[w("div",ge,H(n),1),e.DEFAULT?(m(),b("div",ke,[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${e.DEFAULT.key.slice(2)});`),class:"",onClick:i=>v(i,e.DEFAULT.key),onMouseenter:i=>p(i,e.DEFAULT.key),onMouseleave:k},null,44,he),[[u,{placement:"top",content:`var(${e.DEFAULT.key}, ${e.DEFAULT.value})`}]])])):D("",!0),e.shades&&Object.keys(e.shades).length>0?(m(),b("div",{key:1,style:V(`--wp-b-v-items-grid: ${Object.keys(e.shades).length}`),class:"variable-section-items shades-colors"},[(m(!0),b(z,null,M(e.shades,(i,f)=>(m(),b("div",{key:f,class:""},[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${i.key.slice(2)})`),onClick:h=>v(h,i.key),onMouseenter:h=>p(h,i.key),onMouseleave:k},null,44,we),[[u,{placement:"top",content:`var(${i.key}, ${i.value})`}]])]))),128))],4)):D("",!0)]))),128))])}}},$e=P(Ee,[["__scopeId","data-v-c22ad97c"]]),Ce={id:"windpressbricks-variable-app-body",class:"var-body"},Ie={__name:"PanelBody",setup(r){const t=$({colors:{},typography:{},sizing:{}}),o=_("focusedInput"),g=_("recentColorPickerTarget");async function c(){const s=Re.contentWindow.document.querySelector('script#windpress\\:vfs[type="text/plain"]'),d=Ge(s.textContent),y=await Je(await Qe({volume:d})),l={};y.filter(e=>e.key.startsWith("--color")).forEach(e=>{const n=e.key.slice(8),i=n.split("-");let f="";if(i.length>1){const h=i[0],qe=i.slice(1).join("-");f=`${h}.shades.'${qe}'`}else f=`${n}.DEFAULT`;tt(l,f,e)}),t.value.colors=Object.keys(l).sort().reduce((e,n)=>(e[n]=l[n],e),{});const a={font_size:[],line_height:[],letter_spacing:[]};y.filter(e=>e.key.startsWith("--text-")&&!e.key.endsWith("--line-height")).forEach(e=>{const n=e.key.slice(7);a.font_size.push({key:e.key,label:n,value:e.value})}),y.filter(e=>e.key.startsWith("--leading-")||e.key.endsWith("--leading")).forEach(e=>{const n=e.key.startsWith("--leading-")?e.key.slice(10):e.key.slice(2,-9);a.line_height.push({key:e.key,label:n,value:e.value})}),a.line_height.sort((e,n)=>e.label.startsWith("font-size-")&&!n.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&n.label.startsWith("font-size-")?-1:0),y.filter(e=>e.key.startsWith("--tracking-")).forEach(e=>{const n=e.key.slice(11);a.letter_spacing.push({key:e.key,label:n,value:e.value})}),t.value.typography=a;const u={container:[],breakpoint:[]};y.filter(e=>e.key.startsWith("--container-")).forEach(e=>{const n=e.key.slice(12);u.container.push({key:e.key,label:n,value:e.value})}),y.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const n=e.key.slice(13);u.breakpoint.push({key:e.key,label:n,value:e.value})}),t.value.sizing=u}const p=$(null),k=$(null),v=$(null);return W(o,s=>{var d,y,l,a;if(s){const u=((y=(d=s.closest("[data-controlkey]"))==null?void 0:d.dataset.controlkey)==null?void 0:y.toLocaleLowerCase())??"",e=["typography","font"].some(f=>u.includes(f)),n=["padding","margin","gap","width","height"].some(f=>u.includes(f)),i=(a=(l=s.parentElement)==null?void 0:l.parentElement)==null?void 0:a.classList.contains("color-input");k.value.togglePanel(!1),v.value.togglePanel(!1),p.value.togglePanel(!1),i?(p.value.togglePanel(!0),p.value.scrollIntoView()):e?(k.value.togglePanel(!0),k.value.scrollIntoView()):n&&(v.value.togglePanel(!0),v.value.scrollIntoView())}}),W(g,s=>{s&&(p.value.togglePanel(!0),p.value.scrollIntoView())}),J(()=>{c()}),new BroadcastChannel("windpress").addEventListener("message",async s=>{const d=s.data;d.source==="windpress/intellisense"&&d.task==="windpress.code-editor.saved.done"&&setTimeout(()=>{c()},1e3)}),(s,d)=>(m(),b("div",Ce,[E(O,{ref_key:"sectionColor",ref:p,namespace:"variable",name:"color"},{header:I(()=>d[0]||(d[0]=[w("span",{class:"var-body-title"},"Color",-1)])),default:I(()=>[E($e,{"variable-items":t.value.colors},null,8,["variable-items"])]),_:1},512),E(O,{ref_key:"sectionTypography",ref:k,namespace:"variable",name:"typography"},{header:I(()=>d[1]||(d[1]=[w("span",{class:"var-body-title"},"Typography",-1)])),default:I(()=>[E(N,{"variable-items":t.value.typography},null,8,["variable-items"])]),_:1},512),E(O,{ref_key:"sectionSpacing",ref:v,namespace:"variable",name:"spacing",class:""},{header:I(()=>d[2]||(d[2]=[w("span",{class:"var-body-title"},"Sizing",-1)])),default:I(()=>[E(N,{"variable-items":t.value.sizing},null,8,["variable-items"])]),_:1},512)]))}},xe=P(Ie,[["__scopeId","data-v-cb1fc473"]]),Se={id:"windpressbricks-variable-app-container",class:"wp-b-var-container"},Pe={__name:"App",setup(r){const t=_("isOpen");return(o,g)=>T((m(),b("div",Se,[E(ne),(m(),Ne(Xe,null,{default:I(()=>[E(xe)]),_:1}))],512)),[[Ve,x(t)]])}},Te=P(Pe,[["__scopeId","data-v-8a9882a1"]]),L=document.createElement("windpressbricks-variable-app");L.id="windpressbricks-variable-app",document.body.appendChild(L);const S=$(!1),A=$(null),X=$(null),F=$(null),Le=$(0),C=De(Te);C.config.globalProperties.windpressbricks=window.windpressbricks,C.provide("variableApp",L),C.provide("isOpen",S),C.provide("focusedInput",A),C.provide("tempInputValue",X),C.provide("recentColorPickerTarget",F),C.provide("recentVariableSelectionTimestamp",Le),C.use(je,{container:"#windpressbricks-variable-app"}),C.component("InlineSvg",Fe),C.mount("#windpressbricks-variable-app");function Y(r){var t;!r.shiftKey||!r.target||((t=document==null?void 0:document.getSelection())==null||t.removeAllRanges(),r.preventDefault(),r.stopPropagation(),A.value=r.target,X.value=r.target.value,S.value=!0)}function G(r){A.value=r.target}const Ae=['div[data-control="number"]',{selector:'div[data-control="text"]',hasChild:["#_flexBasis","#_overflow","#_gridTemplateColumns","#_gridTemplateRows","#_gridAutoColumns","#_gridAutoRows","#_objectPosition",'[id^="raw-"]']}];function K(){setTimeout(()=>{Ae.forEach(r=>{(typeof r=="string"?[...document.querySelectorAll(r)]:[...document.querySelectorAll(r.selector)].filter(t=>r.hasChild.some(o=>t.querySelector(o)))).forEach(t=>{const o=t.querySelector("input[type='text']");(o==null?void 0:o.getAttribute("windpressbricks-variable-app"))!=="listened"&&(o==null||o.removeEventListener("click",Y),o==null||o.addEventListener("click",Y),o==null||o.removeEventListener("focus",G),o==null||o.addEventListener("focus",G),o==null||o.setAttribute("windpressbricks-variable-app","listened"),o==null||o.parentNode.setAttribute("data-balloon","Shift + click to open the Variable Picker"),o==null||o.parentNode.setAttribute("data-balloon-pos","bottom-right"))})}),[...document.querySelectorAll(".bricks-control-preview")].filter(r=>{var t,o;return((o=(t=r.closest(".control-inner"))==null?void 0:t.querySelector("label"))==null?void 0:o.getAttribute("for"))==="color"}).forEach(r=>{r.addEventListener("contextmenu",t=>{var o;!t.shiftKey||!t.target||(t.preventDefault(),t.stopPropagation(),(o=document==null?void 0:document.getSelection())==null||o.removeAllRanges(),A.value=null,S.value=!0,F.value=null,Ye(()=>{F.value=t.target}))})})},100)}let R=!1;ye({selector:"#bricks-panel-inner",options:{subtree:!0,childList:!0},callback(){R||(R=!0,K(),setTimeout(()=>{R=!1},100))}}),K(),document.addEventListener("keydown",r=>{r.key==="Escape"&&S.value&&(S.value=!1)}),W(S,r=>{L.style.zIndex=r?"calc(Infinity)":"-1"}),q("Module loaded!",{module:"variable-picker"})});
