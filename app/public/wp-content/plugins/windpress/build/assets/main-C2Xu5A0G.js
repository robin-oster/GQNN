import{brxGlobalProp as p,brxIframe as S}from"./constant-ClLhar2j.js";import{d as j}from"./vfs-D2UpcTQ4.js";import"./index-Cpd--BI3.min.js";import{__tla as A}from"./cssesc-oI9k1TGw.js";import"./index-C5HG4pYD.min.js";import{__tla as M}from"./index-B1TOZHNa.min.js";import{g as O}from"./intellisense-C4SCibOB.js";import{c as W}from"./index.browser-B0na17u1.min.js";import"./redaxios.module-D8m3meIN.min.js";import{l as z}from"./design-system-BcwYkYVv.js";import{l as q}from"./logger-BTW-zIW3.js";import"./virtualRef-CgRKHaPH.js";import"./index-l5GBeiGs.min.js";import"./isObject-K1YoVIH1.min.js";import"./runtime-core.esm-bundler-HqF9pg4M.min.js";import"./set-Dt5k9sTt.min.js";import"./_toKey-BxB36GnB.min.js";import"./get-DBhW7rda.min.js";import"./chunk-HTB5LLOP-Cay67bh1.min.js";import"./preload-helper-CsYsLKPR.min.js";import"./source-map-generator-DjbDy59a.min.js";import"./index-CgqXENQe.min.js";import"./index-BAMY2Nnw.min.js";import"./index-BkiRcEwW.min.js";import"./pre-process-BSusP0Xd.js";Promise.all([(()=>{try{return A}catch{}})(),(()=>{try{return M}catch{}})()]).then(async()=>{const m=()=>W("1234567890abcdefghijklmnopqrstuvwxyz",6)();function x(){let r=m();for(;r.match(/^\d/);)r=m();return`windpress${r}`}async function v(){p.$_state.globalVariables=p.$_state.globalVariables.filter(o=>o.category!=="windpress"),p.$_state.globalVariablesCategories.find(o=>o.id==="windpress")||p.$_state.globalVariablesCategories.push({id:"windpress",name:"WindPress"});const r=S.contentWindow.document.querySelector('script#windpress\\:vfs[type="text/plain"]'),s=j(r.textContent);(await O(await z({volume:s}))).forEach(o=>{var l;(l=o.value)!=null&&l.includes("--")||p.$_state.globalVariables.push({id:x(),name:o.key.substring(2),value:o.value,category:"windpress"})})}new BroadcastChannel("windpress").addEventListener("message",async r=>{const s=r.data;s.source==="windpress/intellisense"&&s.task==="windpress.code-editor.saved.done"&&setTimeout(()=>{v()},1e3)}),v();function C(){var E,_,k,L;if(p.$_state.activePanel!=="element"||!((_=(E=p.$_state)==null?void 0:E.activeElement)!=null&&_.id)||!((k=S)!=null&&k.contentWindow))return;const r=document.querySelector(".expand .options-wrapper"),s=r==null?void 0:r.querySelector(".searchable"),o=r==null?void 0:r.querySelector(".dropdown"),l=o==null?void 0:o.querySelectorAll(".variable-picker-item:not(.title)"),n=(L=document.querySelector(".variable-picker-button.open"))==null?void 0:L.previousElementSibling;if(!n||!(l!=null&&l.length)||!r||!o||!s)return;const $=e=>{var t;const i=((t=e.querySelector("span:first-of-type"))==null?void 0:t.textContent)??"";!n||!i||y(h(i))},I=e=>{var a;const i=((a=e.querySelector("span:first-of-type"))==null?void 0:a.textContent)??"";if(!n||!i)return;const t=h(i);n.value=t,n.click()},P=(e,i)=>{e.forEach(t=>{t.isIntersecting&&!t.target.classList.contains("open")&&t.target.click()})},f=()=>{y(V);const e=n.nextElementSibling;g.observe(e),r.removeEventListener("mouseleave",f)},w=(e,i)=>{e.forEach(t=>{const[a,d]=Object.entries(t)[0]||[];i.insertAdjacentHTML("beforeend",`
                <li class="variable-picker-item">
                    <span>${a}</span>
                    <span class="option-value">${d}</span>
                </li>
            `)}),c.querySelectorAll(".variable-picker-item").forEach(t=>{t.addEventListener("mouseenter",()=>$(t)),t.addEventListener("click",()=>I(t))})},y=e=>{n.value=e,n.dispatchEvent(new Event("input")),n.focus()},h=e=>`var(--${e})`,u=[];o.remove(),l.forEach(e=>{var a,d;const i=((a=e.querySelector("span:first-of-type"))==null?void 0:a.textContent)??"",t=((d=e.querySelector("span.option-value"))==null?void 0:d.textContent)??"";u.push({[i]:t})});const c=document.createElement("ul");c.classList.add("custom-dropdown"),c.setAttribute("style",`
        max-height: calc(32px * 10);
        overflow: hidden;
        overflow-y: auto;
        position: relative;
        scrollbar-color: rgba(0, 0, 0, .4) rgba(0, 0, 0, .2);
        scrollbar-width: thin;
    `),w(u,c),r.appendChild(c),s.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation()}),s.addEventListener("input",e=>{const i=u.filter(t=>{var a;return(((a=Object.keys(t)[0])==null?void 0:a.toLowerCase())??"").includes(s.value.toLowerCase())});c.innerHTML="",w(i,c)});let V=(n==null?void 0:n.value)??" ";const g=new IntersectionObserver(P,{root:n.parentElement});r.addEventListener("mouseleave",f),g.disconnect()}const b=document.querySelector("#bricks-panel-inner:not(div.bricks-control-popup *)");if(!b)throw q("Inner panel not found, can't initialize preview of variables on hover",{module:"variables",type:"error"}),new Error("Inner panel not found, can't initialize preview of variables on hover");new MutationObserver(C).observe(b,{subtree:!0,childList:!0,attributes:!0}),q("Module loaded!",{module:"variables"})});
