import{l as e}from"../../logger-BTW-zIW3.js";import{d as v}from"../../debounce-BB-8SLfJ.min.js";import"../../isObject-K1YoVIH1.min.js";e("Loading..."),(async()=>{let s,o;for(e("waiting for the rootContainer...");!s;)s=document.querySelector("div#site-editor"),await new Promise(t=>setTimeout(t,100));e("finding WindPress script...");let a=!1,u=setTimeout(()=>{a=!0},45e3);for(;!a;){if(o=document.querySelectorAll("script"),o=Array.from(o).filter(t=>{let i=t.getAttribute("id");return i&&(i.startsWith("windpress:")||i.startsWith("vite-client"))&&!i.startsWith("windpress:integration-")}),o.length>0){clearTimeout(u);break}await new Promise(t=>setTimeout(t,100))}if(a){e("time out! failed to find WindPress script");return}e("found WindPress script");async function m(){let t=[],i=!1,p=setTimeout(()=>{i=!0},45e3);for(;!i;){let r=document.querySelector("iframe.edit-site-visual-editor__editor-canvas");if(t=[...document.querySelectorAll("div.block-editor-block-preview__container > div > div > div.block-editor-iframe__scale-container > iframe")],r&&t.push(r),t.length>0){clearTimeout(p);break}await new Promise(c=>setTimeout(c,100))}if(i){e("time out! failed to find editor canvas");return}for(e("found editor canvas"),e("waiting for the canvas loader to be removed...");document.querySelector("div.edit-site-canvas-loader")!==null;)await new Promise(r=>setTimeout(r,200));e("canvas loader removed"),t.forEach(async r=>{let c=r.contentWindow||r,d=r.contentDocument||c.document;for(;!d.head;)await new Promise(n=>setTimeout(n,300));e("injecting WindPress script into the root container");let h=d.querySelectorAll("script");Array.from(h).some(n=>{let l=n.getAttribute("id");return l&&l.startsWith("windpress:")})?e("WindPress script is already injected, skipping the injection process..."):(e("starting the root injection process..."),o.forEach(n=>{d.head.appendChild(document.createRange().createContextualFragment(n.outerHTML))}))})}const f=v(m,1e3);new MutationObserver(()=>{f()}).observe(s,{subtree:!0,childList:!0})})();
