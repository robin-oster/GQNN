import{_ as v}from"../../preload-helper-CsYsLKPR.min.js";import{t as B,f as $}from"../../tippy.esm-C2cIAwYP.min.js";import{n as I,H as D}from"../../highlight-in-textarea-B9VLDWt4.js";import{T as H}from"../../tribute.esm-DK9UGgwV.min.js";import{c as q,a as F}from"../../index-lmgDaERr.min.js";import{d as O}from"../../debounce-BB-8SLfJ.min.js";import{V as d,w as M,n as b}from"../../runtime-core.esm-bundler-HqF9pg4M.min.js";import"../../index-BAMY2Nnw.min.js";import"../../index-CgqXENQe.min.js";import"../../isObject-K1YoVIH1.min.js";(async()=>{const T=e=>React.createElement("svg",{id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",...e},React.createElement("g",null,React.createElement("path",{fill:"currentColor",d:"M176,384H16c-8.832,0-16,7.168-16,16c0,8.832,7.168,16,16,16h160c8.832,0,16,7.2,16,16s-7.168,16-16,16 c-8.832,0-16,7.168-16,16c0,8.832,7.168,16,16,16c26.464,0,48-21.536,48-48S202.464,384,176,384z"})),React.createElement("g",null,React.createElement("path",{d:"M240,256c-8.832,0-16,7.168-16,16c0,8.832,7.168,16,16,16c8.832,0,16,7.2,16,16s-7.168,16-16,16H16 c-8.832,0-16,7.168-16,16c0,8.832,7.168,16,16,16h224c26.464,0,48-21.536,48-48S266.464,256,240,256z"})),React.createElement("g",null,React.createElement("path",{d:"M288,32C164.288,32,64,132.288,64,256c0,10.88,1.056,21.536,2.56,32h128.192c-1.792-4.992-2.752-10.4-2.752-16 c0-26.464,21.536-48,48-48c44.096,0,80,35.904,80,80c0,44.128-35.904,80-80,80h-0.416C249.76,397.408,256,413.92,256,432 c0,16.032-4.864,30.944-13.024,43.456c14.56,2.976,29.6,4.544,45.024,4.544c123.712,0,224-100.288,224-224S411.712,32,288,32z"})));let E=null;const A=e=>React.createElement(T,{...e,width:20,height:20,"aria-hidden":"true",focusable:"false"});(async()=>E=await q({themes:[v(()=>import("../../dark-plus-C3mMm8J8.min.js"),[],import.meta.url),v(()=>import("../../light-plus-B7mTdjB0.min.js"),[],import.meta.url)],langs:[v(()=>import("../../css-DPfMkruS.min.js"),[],import.meta.url)],engine:F(v(()=>import("../../wasm-CG6Dc4jp.min.js"),[],import.meta.url))}))();const r=d(null);let R=null,_=[];wp.hooks.addAction("windpressgutenberg-autocomplete-items-refresh","windpressgutenberg",()=>{_=wp.hooks.applyFilters("windpressgutenberg-autocomplete-items",[],"")}),wp.hooks.doAction("windpressgutenberg-autocomplete-items-refresh");const c=new H({containerClass:"windpressgutenberg-tribute-container",autocompleteMode:!0,menuItemLimit:50,noMatchTemplate:"",values:async function(e,t){const n=await wp.hooks.applyFilters("windpressgutenberg-autocomplete-items-query",_,e);t(n)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let t="";return e.original.color!==void 0&&(t+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(t+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${t}"></span>
        `}});c.setMenuContainer=function(e){this.menuContainer=e};const N=c.events.callbacks;c.events.callbacks=function(){return{...N.call(this),up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length,s=this.tribute.menuSelected;n>s&&s>0?(this.tribute.menuSelected--,this.setActiveLi()):s===0&&(this.tribute.menuSelected=n-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),y()}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let n=this.tribute.current.filteredItems.length-1,s=this.tribute.menuSelected;n>s?(this.tribute.menuSelected++,this.setActiveLi()):n===s&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),y()}}}};let p=B(document.createElement("div"),{plugins:[$],allowHTML:!0,arrow:!1,duration:[500,0],followCursor:!0,trigger:"manual"});function k(){const e=document.querySelector(".hit-container");if(e===null)return;p.reference=e;async function t(a){const i=a.textContent,o=await window.windpress.module.classnameToCss.generate(i);if(o===null||o.trim()==="")return null;p.setContent(E.codeToHtml(o,{lang:"css",theme:"dark-plus"})),p.show()}const n=d(null),s=O(function(a){const i=a.clientX,o=a.clientY,f=document.elementsFromPoint(i,o).find(l=>l.matches('mark[class="word"]'));n.value=f||null},10);e.addEventListener("mousemove",s),e.addEventListener("mouseleave",function(a){s.cancel(),n.value=null}),M(n,(a,i)=>{a&&a!==i?t(a):p.hide()})}const g=d(null),u=d(null),m=d(null);function y(){let e=c.menu.querySelector("li.highlight>span.class-name");m.value&&w(m.value),m.value=e.dataset.tributeClassName,C(e.dataset.tributeClassName)}let h=null;const x=new MutationObserver(function(e){e.forEach(function(t){t.type==="childList"&&t.addedNodes.length>0&&t.addedNodes.forEach(n=>{const s=n.querySelector(".class-name").dataset.tributeClassName;n.addEventListener("mouseenter",a=>{C(s)}),n.addEventListener("mouseleave",a=>{w(s)}),n.addEventListener("click",a=>{},{capture:!0})})})});function L(){const e=document.querySelector('iframe[name="editor-canvas"]'),t=(e==null?void 0:e.contentWindow)||e;return(e==null?void 0:e.contentDocument)||(t==null?void 0:t.document)}function C(e){const t=L();if(!t)return;const n=t.getElementById(`block-${g.value}`);n&&n.classList.add(e)}function w(e){const t=L();if(!t)return;const n=t.getElementById(`block-${g.value}`);n&&u.value&&!u.value.includes(e)&&n.classList.remove(e)}M(r,(e,t)=>{e&&(I(r.value),c.attach(r.value),setTimeout(()=>{R=new D(r.value,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]}),k(),r.value.addEventListener("highlights-updated",function(n){k()}),r.value.addEventListener("tribute-active-true",function(n){h===null&&(h=document.querySelector(".windpressgutenberg-tribute-container>ul")),b(()=>{h&&x.observe(h,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})}),r.value.addEventListener("tribute-active-false",function(n){m.value&&w(m.value)}),b(()=>{S()})},10))});function S(){b(()=>{try{R.handleInput()}catch{}I.update(r.value),c.hideMenu()})}function P(e){return t=>{const{name:n,clientId:s,attributes:a,setAttributes:i}=t;React.useEffect(()=>{g.value=s,u.value=a.className});function o(l){i({className:l}),u.value=l}async function f(){const l=await windpress.module.classSorter.sort(a.className);i({className:l}),u.value=l,S()}return React.createElement(React.Fragment,null,React.createElement(e,{...t}),React.createElement(wp.blockEditor.InspectorControls,null,React.createElement(wp.components.PanelBody,{title:wp.i18n.__("WindPress","windpress"),icon:A,initialOpen:!0},React.createElement(wp.components.PanelRow,{className:"windpressgutenberg-actions"},React.createElement("div",null,React.createElement(wp.components.Button,{showTooltip:!0,variant:"secondary",label:wp.i18n.__("Automatic Class Sorting","windpress"),onClick:f},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"tabler-icon tabler-icon-reorder icon icon-tabler icons-tabler-outline icon-tabler-reorder"},React.createElement("path",{d:"M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),React.createElement("path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),React.createElement("path",{d:"M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),React.createElement("path",{d:"M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3"}),React.createElement("path",{d:"M16.5 8.5l2.5 2.5l2.5 -2.5"}))))),React.createElement(wp.components.TextareaControl,{__nextHasNoMarginBottom:!0,value:a.className,onChange:l=>o(l),onInput:l=>o(l.target.value),ref:l=>r.value=l}))))}}wp.hooks.addFilter("editor.BlockEdit","windpress/add-class-inspector-controls",P)})();
