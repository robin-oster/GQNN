const X=["top","right","bottom","left"],Y=["start","end"],Z=X.reduce((t,e)=>t.concat(e,e+"-"+Y[0],e+"-"+Y[1]),[]),$=Math.min,W=Math.max,st=Math.round,ct=Math.floor,ft=t=>({x:t,y:t}),mt={left:"right",right:"left",bottom:"top",top:"bottom"},ut={start:"end",end:"start"};function J(t,e,a){return W(t,$(e,a))}function M(t,e){return typeof t=="function"?t(e):t}function S(t){return t.split("-")[0]}function k(t){return t.split("-")[1]}function K(t){return t==="x"?"y":"x"}function N(t){return t==="y"?"height":"width"}const dt=new Set(["top","bottom"]);function B(t){return dt.has(S(t))?"y":"x"}function Q(t){return K(B(t))}function _(t,e,a){a===void 0&&(a=!1);const n=k(t),r=Q(t),o=N(r);let i=r==="x"?n===(a?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(i=I(i)),[i,I(i)]}function pt(t){const e=I(t);return[G(t),e,G(e)]}function G(t){return t.replace(/start|end/g,e=>ut[e])}const tt=["left","right"],et=["right","left"],gt=["top","bottom"],ht=["bottom","top"];function yt(t,e,a){switch(t){case"top":case"bottom":return a?e?et:tt:e?tt:et;case"left":case"right":return e?gt:ht;default:return[]}}function wt(t,e,a,n){const r=k(t);let o=yt(S(t),a==="start",n);return r&&(o=o.map(i=>i+"-"+r),e&&(o=o.concat(o.map(G)))),o}function I(t){return t.replace(/left|right|bottom|top/g,e=>mt[e])}function xt(t){return{top:0,right:0,bottom:0,left:0,...t}}function nt(t){return typeof t!="number"?xt(t):{top:t,right:t,bottom:t,left:t}}function U(t){const{x:e,y:a,width:n,height:r}=t;return{width:n,height:r,top:a,left:e,right:e+n,bottom:a+r,x:e,y:a}}function ot(t,e,a){let{reference:n,floating:r}=t;const o=B(e),i=Q(e),u=N(i),h=S(e),y=o==="y",c=n.x+n.width/2-r.width/2,s=n.y+n.height/2-r.height/2,m=n[u]/2-r[u]/2;let l;switch(h){case"top":l={x:c,y:n.y-r.height};break;case"bottom":l={x:c,y:n.y+n.height};break;case"right":l={x:n.x+n.width,y:s};break;case"left":l={x:n.x-r.width,y:s};break;default:l={x:n.x,y:n.y}}switch(k(e)){case"start":l[i]-=m*(a&&y?-1:1);break;case"end":l[i]+=m*(a&&y?-1:1);break}return l}const vt=async(t,e,a)=>{const{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:i}=a,u=o.filter(Boolean),h=await(i.isRTL==null?void 0:i.isRTL(e));let y=await i.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:s}=ot(y,n,h),m=n,l={},f=0;for(let d=0;d<u.length;d++){const{name:p,fn:x}=u[d],{x:g,y:w,data:b,reset:v}=await x({x:c,y:s,initialPlacement:n,placement:m,strategy:r,middlewareData:l,rects:y,platform:i,elements:{reference:t,floating:e}});c=g??c,s=w??s,l={...l,[p]:{...l[p],...b}},v&&f<=50&&(f++,typeof v=="object"&&(v.placement&&(m=v.placement),v.rects&&(y=v.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:r}):v.rects),{x:c,y:s}=ot(y,m,h)),d=-1)}return{x:c,y:s,placement:m,strategy:r,middlewareData:l}};async function q(t,e){var a;e===void 0&&(e={});const{x:n,y:r,platform:o,rects:i,elements:u,strategy:h}=t,{boundary:y="clippingAncestors",rootBoundary:c="viewport",elementContext:s="floating",altBoundary:m=!1,padding:l=0}=M(e,t),f=nt(l),d=u[m?s==="floating"?"reference":"floating":s],p=U(await o.getClippingRect({element:(a=await(o.isElement==null?void 0:o.isElement(d)))==null||a?d:d.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:y,rootBoundary:c,strategy:h})),x=s==="floating"?{x:n,y:r,width:i.floating.width,height:i.floating.height}:i.reference,g=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),w=await(o.isElement==null?void 0:o.isElement(g))?await(o.getScale==null?void 0:o.getScale(g))||{x:1,y:1}:{x:1,y:1},b=U(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:x,offsetParent:g,strategy:h}):x);return{top:(p.top-b.top+f.top)/w.y,bottom:(b.bottom-p.bottom+f.bottom)/w.y,left:(p.left-b.left+f.left)/w.x,right:(b.right-p.right+f.right)/w.x}}const bt=t=>({name:"arrow",options:t,async fn(e){const{x:a,y:n,placement:r,rects:o,platform:i,elements:u,middlewareData:h}=e,{element:y,padding:c=0}=M(t,e)||{};if(y==null)return{};const s=nt(c),m={x:a,y:n},l=Q(r),f=N(l),d=await i.getDimensions(y),p=l==="y",x=p?"top":"left",g=p?"bottom":"right",w=p?"clientHeight":"clientWidth",b=o.reference[f]+o.reference[l]-m[l]-o.floating[f],v=m[l]-o.reference[l],O=await(i.getOffsetParent==null?void 0:i.getOffsetParent(y));let D=O?O[w]:0;(!D||!await(i.isElement==null?void 0:i.isElement(O)))&&(D=u.floating[w]||o.floating[f]);const T=b/2-v/2,A=D/2-d[f]/2-1,R=$(s[x],A),H=$(s[g],A),E=R,V=D-d[f]-H,P=D/2-d[f]/2+T,z=J(E,P,V),C=!h.arrow&&k(r)!=null&&P!==z&&o.reference[f]/2-(P<E?R:H)-d[f]/2<0,L=C?P<E?P-E:P-V:0;return{[l]:m[l]+L,data:{[l]:z,centerOffset:P-z-L,...C&&{alignmentOffset:L}},reset:C}}});function At(t,e,a){return(t?[...a.filter(n=>k(n)===t),...a.filter(n=>k(n)!==t)]:a.filter(n=>S(n)===n)).filter(n=>t?k(n)===t||(e?G(n)!==n:!1):!0)}const Rt=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var a,n,r;const{rects:o,middlewareData:i,placement:u,platform:h,elements:y}=e,{crossAxis:c=!1,alignment:s,allowedPlacements:m=Z,autoAlignment:l=!0,...f}=M(t,e),d=s!==void 0||m===Z?At(s||null,l,m):m,p=await q(e,f),x=((a=i.autoPlacement)==null?void 0:a.index)||0,g=d[x];if(g==null)return{};const w=_(g,o,await(h.isRTL==null?void 0:h.isRTL(y.floating)));if(u!==g)return{reset:{placement:d[0]}};const b=[p[S(g)],p[w[0]],p[w[1]]],v=[...((n=i.autoPlacement)==null?void 0:n.overflows)||[],{placement:g,overflows:b}],O=d[x+1];if(O)return{data:{index:x+1,overflows:v},reset:{placement:O}};const D=v.map(A=>{const R=k(A.placement);return[A.placement,R&&c?A.overflows.slice(0,2).reduce((H,E)=>H+E,0):A.overflows[0],A.overflows]}).sort((A,R)=>A[1]-R[1]),T=((r=D.filter(A=>A[2].slice(0,k(A[0])?2:3).every(R=>R<=0))[0])==null?void 0:r[0])||D[0][0];return T!==u?{data:{index:x+1,overflows:v},reset:{placement:T}}:{}}}},Pt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var a,n;const{placement:r,middlewareData:o,rects:i,initialPlacement:u,platform:h,elements:y}=e,{mainAxis:c=!0,crossAxis:s=!0,fallbackPlacements:m,fallbackStrategy:l="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:d=!0,...p}=M(t,e);if((a=o.arrow)!=null&&a.alignmentOffset)return{};const x=S(r),g=B(u),w=S(u)===u,b=await(h.isRTL==null?void 0:h.isRTL(y.floating)),v=m||(w||!d?[I(u)]:pt(u)),O=f!=="none";!m&&O&&v.push(...wt(u,d,f,b));const D=[u,...v],T=await q(e,p),A=[];let R=((n=o.flip)==null?void 0:n.overflows)||[];if(c&&A.push(T[x]),s){const P=_(r,i,b);A.push(T[P[0]],T[P[1]])}if(R=[...R,{placement:r,overflows:A}],!A.every(P=>P<=0)){var H,E;const P=(((H=o.flip)==null?void 0:H.index)||0)+1,z=D[P];if(z&&(!(s==="alignment"&&g!==B(z))||R.every(L=>L.overflows[0]>0&&B(L.placement)===g)))return{data:{index:P,overflows:R},reset:{placement:z}};let C=(E=R.filter(L=>L.overflows[0]<=0).sort((L,j)=>L.overflows[1]-j.overflows[1])[0])==null?void 0:E.placement;if(!C)switch(l){case"bestFit":{var V;const L=(V=R.filter(j=>{if(O){const F=B(j.placement);return F===g||F==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(F=>F>0).reduce((F,lt)=>F+lt,0)]).sort((j,F)=>j[1]-F[1])[0])==null?void 0:V[0];L&&(C=L);break}case"initialPlacement":C=u;break}if(r!==C)return{reset:{placement:C}}}return{}}}};function it(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function at(t){return X.some(e=>t[e]>=0)}const Ot=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:a}=e,{strategy:n="referenceHidden",...r}=M(t,e);switch(n){case"referenceHidden":{const o=await q(e,{...r,elementContext:"reference"}),i=it(o,a.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:at(i)}}}case"escaped":{const o=await q(e,{...r,altBoundary:!0}),i=it(o,a.floating);return{data:{escapedOffsets:i,escaped:at(i)}}}default:return{}}}}},rt=new Set(["left","top"]);async function Dt(t,e){const{placement:a,platform:n,elements:r}=t,o=await(n.isRTL==null?void 0:n.isRTL(r.floating)),i=S(a),u=k(a),h=B(a)==="y",y=rt.has(i)?-1:1,c=o&&h?-1:1,s=M(e,t);let{mainAxis:m,crossAxis:l,alignmentAxis:f}=typeof s=="number"?{mainAxis:s,crossAxis:0,alignmentAxis:null}:{mainAxis:s.mainAxis||0,crossAxis:s.crossAxis||0,alignmentAxis:s.alignmentAxis};return u&&typeof f=="number"&&(l=u==="end"?f*-1:f),h?{x:l*c,y:m*y}:{x:m*y,y:l*c}}const Lt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var a,n;const{x:r,y:o,placement:i,middlewareData:u}=e,h=await Dt(e,t);return i===((a=u.offset)==null?void 0:a.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:r+h.x,y:o+h.y,data:{...h,placement:i}}}}},Tt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:a,y:n,placement:r}=e,{mainAxis:o=!0,crossAxis:i=!1,limiter:u={fn:p=>{let{x,y:g}=p;return{x,y:g}}},...h}=M(t,e),y={x:a,y:n},c=await q(e,h),s=B(S(r)),m=K(s);let l=y[m],f=y[s];if(o){const p=m==="y"?"top":"left",x=m==="y"?"bottom":"right",g=l+c[p],w=l-c[x];l=J(g,l,w)}if(i){const p=s==="y"?"top":"left",x=s==="y"?"bottom":"right",g=f+c[p],w=f-c[x];f=J(g,f,w)}const d=u.fn({...e,[m]:l,[s]:f});return{...d,data:{x:d.x-a,y:d.y-n,enabled:{[m]:o,[s]:i}}}}}},Et=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:a,y:n,placement:r,rects:o,middlewareData:i}=e,{offset:u=0,mainAxis:h=!0,crossAxis:y=!0}=M(t,e),c={x:a,y:n},s=B(r),m=K(s);let l=c[m],f=c[s];const d=M(u,e),p=typeof d=="number"?{mainAxis:d,crossAxis:0}:{mainAxis:0,crossAxis:0,...d};if(h){const w=m==="y"?"height":"width",b=o.reference[m]-o.floating[w]+p.mainAxis,v=o.reference[m]+o.reference[w]-p.mainAxis;l<b?l=b:l>v&&(l=v)}if(y){var x,g;const w=m==="y"?"width":"height",b=rt.has(S(r)),v=o.reference[s]-o.floating[w]+(b&&((x=i.offset)==null?void 0:x[s])||0)+(b?0:p.crossAxis),O=o.reference[s]+o.reference[w]+(b?0:((g=i.offset)==null?void 0:g[s])||0)-(b?p.crossAxis:0);f<v?f=v:f>O&&(f=O)}return{[m]:l,[s]:f}}}},St=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var a,n;const{placement:r,rects:o,platform:i,elements:u}=e,{apply:h=()=>{},...y}=M(t,e),c=await q(e,y),s=S(r),m=k(r),l=B(r)==="y",{width:f,height:d}=o.floating;let p,x;s==="top"||s==="bottom"?(p=s,x=m===(await(i.isRTL==null?void 0:i.isRTL(u.floating))?"start":"end")?"left":"right"):(x=s,p=m==="end"?"top":"bottom");const g=d-c.top-c.bottom,w=f-c.left-c.right,b=$(d-c[p],g),v=$(f-c[x],w),O=!e.middlewareData.shift;let D=b,T=v;if((a=e.middlewareData.shift)!=null&&a.enabled.x&&(T=w),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(D=g),O&&!m){const R=W(c.left,0),H=W(c.right,0),E=W(c.top,0),V=W(c.bottom,0);l?T=f-2*(R!==0||H!==0?R+H:W(c.left,c.right)):D=d-2*(E!==0||V!==0?E+V:W(c.top,c.bottom))}await h({...e,availableWidth:T,availableHeight:D});const A=await i.getDimensions(u.floating);return f!==A.width||d!==A.height?{reset:{rects:!0}}:{}}}};export{Rt as a,bt as b,vt as c,St as d,ft as e,Pt as f,st as g,Ot as h,$ as i,ct as j,Et as l,W as m,Lt as o,U as r,Tt as s};
