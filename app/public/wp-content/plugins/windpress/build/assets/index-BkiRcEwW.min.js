var B,L;function J(){if(L)return B;L=1;var C=40,i=41,o=39,l=34,t=92,a=47,u=44,c=58,f=42,h=117,I=85,w=43,_=/^[a-f0-9?-]+$/i;return B=function(z){for(var A=[],s=z,e,$,O,n,E,v,x,m,d=0,r=s.charCodeAt(d),H=s.length,y=[{nodes:A}],g=0,p,b="",S="",j="";d<H;)if(r<=32){e=d;do e+=1,r=s.charCodeAt(e);while(r<=32);n=s.slice(d,e),O=A[A.length-1],r===i&&g?j=n:O&&O.type==="div"?(O.after=n,O.sourceEndIndex+=n.length):r===u||r===c||r===a&&s.charCodeAt(e+1)!==f&&(!p||p&&p.type==="function"&&p.value!=="calc")?S=n:A.push({type:"space",sourceIndex:d,sourceEndIndex:e,value:n}),d=e}else if(r===o||r===l){e=d,$=r===o?"'":'"',n={type:"string",sourceIndex:d,quote:$};do if(E=!1,e=s.indexOf($,e+1),~e)for(v=e;s.charCodeAt(v-1)===t;)v-=1,E=!E;else s+=$,e=s.length-1,n.unclosed=!0;while(E);n.value=s.slice(d+1,e),n.sourceEndIndex=n.unclosed?e:e+1,A.push(n),d=e+1,r=s.charCodeAt(d)}else if(r===a&&s.charCodeAt(d+1)===f)e=s.indexOf("*/",d),n={type:"comment",sourceIndex:d,sourceEndIndex:e+2},e===-1&&(n.unclosed=!0,e=s.length,n.sourceEndIndex=e),n.value=s.slice(d+2,e),A.push(n),d=e+2,r=s.charCodeAt(d);else if((r===a||r===f)&&p&&p.type==="function"&&p.value==="calc")n=s[d],A.push({type:"word",sourceIndex:d-S.length,sourceEndIndex:d+n.length,value:n}),d+=1,r=s.charCodeAt(d);else if(r===a||r===u||r===c)n=s[d],A.push({type:"div",sourceIndex:d-S.length,sourceEndIndex:d+n.length,value:n,before:S,after:""}),S="",d+=1,r=s.charCodeAt(d);else if(C===r){e=d;do e+=1,r=s.charCodeAt(e);while(r<=32);if(m=d,n={type:"function",sourceIndex:d-b.length,value:b,before:s.slice(m+1,e)},d=e,b==="url"&&r!==o&&r!==l){e-=1;do if(E=!1,e=s.indexOf(")",e+1),~e)for(v=e;s.charCodeAt(v-1)===t;)v-=1,E=!E;else s+=")",e=s.length-1,n.unclosed=!0;while(E);x=e;do x-=1,r=s.charCodeAt(x);while(r<=32);m<x?(d!==x+1?n.nodes=[{type:"word",sourceIndex:d,sourceEndIndex:x+1,value:s.slice(d,x+1)}]:n.nodes=[],n.unclosed&&x+1!==e?(n.after="",n.nodes.push({type:"space",sourceIndex:x+1,sourceEndIndex:e,value:s.slice(x+1,e)})):(n.after=s.slice(x+1,e),n.sourceEndIndex=e)):(n.after="",n.nodes=[]),d=e+1,n.sourceEndIndex=n.unclosed?e:d,r=s.charCodeAt(d),A.push(n)}else g+=1,n.after="",n.sourceEndIndex=d+1,A.push(n),y.push(n),A=n.nodes=[],p=n;b=""}else if(i===r&&g)d+=1,r=s.charCodeAt(d),p.after=j,p.sourceEndIndex+=j.length,j="",g-=1,y[y.length-1].sourceEndIndex=d,y.pop(),p=y[g],A=p.nodes;else{e=d;do r===t&&(e+=1),e+=1,r=s.charCodeAt(e);while(e<H&&!(r<=32||r===o||r===l||r===u||r===c||r===a||r===C||r===f&&p&&p.type==="function"&&p.value==="calc"||r===a&&p.type==="function"&&p.value==="calc"||r===i&&g));n=s.slice(d,e),C===r?b=n:(h===n.charCodeAt(0)||I===n.charCodeAt(0))&&w===n.charCodeAt(1)&&_.test(n.slice(2))?A.push({type:"unicode-range",sourceIndex:d,sourceEndIndex:e,value:n}):A.push({type:"word",sourceIndex:d,sourceEndIndex:e,value:n}),d=e}for(d=y.length-1;d;d-=1)y[d].unclosed=!0,y[d].sourceEndIndex=s.length;return y[0].nodes},B}var N,U;function K(){return U||(U=1,N=function C(i,o,l){var t,a,u,c;for(t=0,a=i.length;t<a;t+=1)u=i[t],l||(c=o(u,t,i)),c!==!1&&u.type==="function"&&Array.isArray(u.nodes)&&C(u.nodes,o,l),l&&o(u,t,i)}),N}var D,V;function M(){if(V)return D;V=1;function C(o,l){var t=o.type,a=o.value,u,c;return l&&(c=l(o))!==void 0?c:t==="word"||t==="space"?a:t==="string"?(u=o.quote||"",u+a+(o.unclosed?"":u)):t==="comment"?"/*"+a+(o.unclosed?"":"*/"):t==="div"?(o.before||"")+a+(o.after||""):Array.isArray(o.nodes)?(u=i(o.nodes,l),t!=="function"?u:a+"("+(o.before||"")+u+(o.after||"")+(o.unclosed?"":")")):a}function i(o,l){var t,a;if(Array.isArray(o)){for(t="",a=o.length-1;~a;a-=1)t=C(o[a],l)+t;return t}return C(o,l)}return D=i,D}var F,W;function T(){if(W)return F;W=1;var C=45,i=43,o=46,l=101,t=69;function a(u){var c=u.charCodeAt(0),f;if(c===i||c===C){if(f=u.charCodeAt(1),f>=48&&f<=57)return!0;var h=u.charCodeAt(2);return f===o&&h>=48&&h<=57}return c===o?(f=u.charCodeAt(1),f>=48&&f<=57):c>=48&&c<=57}return F=function(u){var c=0,f=u.length,h,I,w;if(f===0||!a(u))return!1;for(h=u.charCodeAt(c),(h===i||h===C)&&c++;c<f&&(h=u.charCodeAt(c),!(h<48||h>57));)c+=1;if(h=u.charCodeAt(c),I=u.charCodeAt(c+1),h===o&&I>=48&&I<=57)for(c+=2;c<f&&(h=u.charCodeAt(c),!(h<48||h>57));)c+=1;if(h=u.charCodeAt(c),I=u.charCodeAt(c+1),w=u.charCodeAt(c+2),(h===l||h===t)&&(I>=48&&I<=57||(I===i||I===C)&&w>=48&&w<=57))for(c+=I===i||I===C?3:2;c<f&&(h=u.charCodeAt(c),!(h<48||h>57));)c+=1;return{number:u.slice(0,c),unit:u.slice(c)}},F}var G,X;function Y(){if(X)return G;X=1;var C=J(),i=K(),o=M();function l(t){return this instanceof l?(this.nodes=C(t),this):new l(t)}return l.prototype.toString=function(){return Array.isArray(this.nodes)?o(this.nodes):""},l.prototype.walk=function(t,a){return i(this.nodes,t,a),this},l.unit=T(),l.walk=i,l.stringify=o,G=l,G}export{Y as r};
